const express=require("express");module.exports=function planToPrice(req,res,next){try{const b=(req.body||{});const plan=(b.plan||"").toString().toLowerCase();const map={starter:process.env.STRIPE_PRICE_STARTER,pro:process.env.STRIPE_PRICE_PRO,scale:process.env.STRIPE_PRICE_SCALE};if(b.priceId){return next();}if(plan){const pid=map[plan];if(!pid){return res.status(400).json({error:"price_not_configured",plan});}req.body.priceId=pid;return next();}return res.status(400).json({error:"plan_required"});}catch(e){return next(e);}};